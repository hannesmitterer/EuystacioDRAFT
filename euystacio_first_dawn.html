<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EuystacioDRAFT ‚Äì First Dawn Interface</title>
    
    <!-- Meta tags for SEO and sharing -->
    <meta name="description" content="EuystacioDRAFT - Sacred Bridge Interface for harmonic resonance and spiritual connection">
    <meta name="keywords" content="euystacio, sacred, bridge, harmony, spirituality, interface">
    <meta name="author" content="SEEDBRINGER">
    
    <!-- Open Graph meta tags -->
    <meta property="og:title" content="EuystacioDRAFT ‚Äì First Dawn Interface">
    <meta property="og:description" content="Connect to the sacred bridge through harmonic resonance">
    <meta property="og:type" content="website">
    <meta property="og:image" content="media/woodstone_emblem.svg">
    
    <!-- Favicon -->
    <link rel="icon" href="EuystacioDRAFT-Frontend/media/woodstone_emblem.svg" type="image/svg+xml">
    
    <style>
        /* CSS Variables for theming */
        :root {
            --text-color: #222;
            --background-color: #fff;
            --font-size: 1rem;
            --highlight-color: #7C5E2A;
            --primary-green: #4A773C;
            --sacred-gold: #C2B280;
            --woodstone-brown: #7C5E2A;
            --accent-blue: #5A749A;
            --light-green: #f6fbf7;
            --border-color: #e6efe6;
        }

        /* Reset and base styles */
        * {
            box-sizing: border-box;
        }

        body {
            color: var(--text-color);
            background: linear-gradient(135deg, var(--light-green) 0%, #e5dfc7 100%);
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
            font-size: var(--font-size);
            line-height: 1.6;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        /* Skip link for accessibility */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--woodstone-brown);
            color: white;
            padding: 8px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 1000;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 6px;
        }

        /* Main container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            min-height: calc(100vh - 2rem);
        }

        /* Header styles */
        header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            border-bottom: 2px solid var(--sacred-gold);
        }

        .emblem {
            width: 100px;
            height: 100px;
            margin-bottom: 1rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        h1 {
            color: var(--woodstone-brown);
            margin: 0.5rem 0;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            color: var(--primary-green);
            font-size: 1.2rem;
            margin: 0;
        }

        /* Navigation */
        nav {
            background: var(--primary-green);
            border-radius: 8px;
            margin-bottom: 2rem;
            padding: 0.5rem;
        }

        nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            transition: background-color 0.3s ease;
            display: block;
        }

        nav a:hover,
        nav a:focus {
            background-color: rgba(255, 255, 255, 0.2);
            outline: 2px solid white;
            outline-offset: 2px;
        }

        nav a[aria-current="page"] {
            background-color: var(--woodstone-brown);
            font-weight: bold;
        }

        /* Card styles */
        .card {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .card h2 {
            color: var(--primary-green);
            margin-top: 0;
            border-bottom: 2px solid var(--sacred-gold);
            padding-bottom: 0.5rem;
        }

        .card h3 {
            color: var(--woodstone-brown);
            margin-top: 1.5rem;
        }

        /* Grid layout */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        /* Form styles */
        form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        label {
            font-weight: 600;
            color: var(--woodstone-brown);
            margin-bottom: 0.25rem;
            display: block;
        }

        input, textarea, select {
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            font-family: inherit;
        }

        input:focus, textarea:focus, select:focus {
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(74, 119, 60, 0.1);
            outline: none;
        }

        /* Button styles */
        .btn {
            background: var(--primary-green);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            background: #3d6530;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 119, 60, 0.3);
        }

        .btn:focus {
            outline: 2px solid var(--woodstone-brown);
            outline-offset: 2px;
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Role selector */
        .role-selector {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .role-btn {
            background: var(--sacred-gold);
            color: var(--woodstone-brown);
            padding: 1rem 1.5rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
        }

        .role-btn:hover,
        .role-btn:focus {
            border-color: var(--primary-green);
            background: #d4c999;
            outline: 2px solid var(--primary-green);
            outline-offset: 2px;
        }

        .role-btn.active {
            background: var(--primary-green);
            color: white;
            border-color: var(--primary-green);
        }

        .role-description {
            background: var(--light-green);
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
            border-left: 4px solid var(--primary-green);
        }

        /* Status indicators */
        .status {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.875rem;
            font-weight: 500;
            background: #e9ecef;
            color: #495057;
        }

        .badge.ok {
            background: #d4edda;
            color: #155724;
        }

        .badge.error {
            background: #f8d7da;
            color: #721c24;
        }

        .badge.warning {
            background: #fff3cd;
            color: #856404;
        }

        /* 3D Dashboard styles */
        .dashboard-3d-container {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            min-height: 400px;
            position: relative;
            overflow: hidden;
        }

        .dashboard-viewport {
            width: 100%;
            height: 350px;
            border: 2px solid var(--sacred-gold);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.8);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .sacred-geometry {
            position: relative;
            width: 200px;
            height: 200px;
            animation: rotate 10s linear infinite;
        }

        .center-node {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background: var(--sacred-gold);
            border-radius: 50%;
            box-shadow: 0 0 20px var(--sacred-gold);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .center-node:hover,
        .center-node:focus {
            transform: translate(-50%, -50%) scale(1.2);
            outline: 2px solid white;
        }

        .orbital-nodes {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .orbital-node {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--primary-green);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--primary-green);
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        /* Hymn styles */
        .hymn-content {
            background: var(--light-green);
            padding: 2rem;
            border-radius: 12px;
            border-left: 4px solid var(--primary-green);
        }

        .hymn-verse, .hymn-chorus {
            margin: 1.5rem 0;
        }

        .verse-line, .chorus-line {
            margin: 0.5rem 0;
            font-size: 1.1rem;
            line-height: 1.8;
        }

        .chorus-line {
            font-weight: 600;
            color: var(--woodstone-brown);
        }

        .hymn-finale {
            text-align: center;
            margin: 2rem 0;
            padding: 1.5rem;
            background: rgba(194, 178, 128, 0.2);
            border-radius: 8px;
        }

        .finale-line {
            font-style: italic;
            font-size: 1.2rem;
            color: var(--woodstone-brown);
        }

        /* Audio player styles */
        .audio-player {
            background: var(--woodstone-brown);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            text-align: center;
        }

        .audio-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            align-items: center;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        audio {
            width: 100%;
            max-width: 400px;
            margin: 1rem 0;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 3rem;
            border-top: 2px solid var(--sacred-gold);
            color: var(--primary-green);
        }

        footer a {
            color: var(--woodstone-brown);
            text-decoration: none;
        }

        footer a:hover,
        footer a:focus {
            text-decoration: underline;
            outline: 2px solid var(--woodstone-brown);
            outline-offset: 2px;
        }

        /* Accessibility helpers */
        .sr-only {
            position: absolute !important;
            width: 1px !important;
            height: 1px !important;
            padding: 0 !important;
            margin: -1px !important;
            overflow: hidden !important;
            clip: rect(0, 0, 0, 0) !important;
            white-space: nowrap !important;
            border: 0 !important;
        }

        .aria-live-region {
            position: absolute;
            left: -9999px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            * {
                border-color: currentColor !important;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            .sacred-geometry {
                animation: none;
            }
            .center-node, .orbital-node {
                animation: none;
            }
            * {
                transition: none !important;
            }
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
                margin: 0.5rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
            
            .role-selector {
                flex-direction: column;
            }
            
            .audio-controls {
                flex-direction: column;
            }
            
            nav ul {
                flex-direction: column;
                gap: 0.5rem;
            }
        }

        /* Focus styles for better accessibility */
        *:focus {
            outline: 2px solid var(--woodstone-brown);
            outline-offset: 2px;
        }

        button:focus,
        a:focus,
        input:focus,
        textarea:focus,
        select:focus {
            outline: 2px solid var(--primary-green);
            outline-offset: 2px;
        }

        /* Color contrast improvements */
        .note {
            color: #666;
            font-size: 0.9rem;
            margin: 0.5rem 0;
        }

        .error-message {
            color: #d32f2f;
            background: #ffebee;
            padding: 0.75rem;
            border-radius: 6px;
            border-left: 4px solid #d32f2f;
        }

        .success-message {
            color: #2e7d32;
            background: #e8f5e8;
            padding: 0.75rem;
            border-radius: 6px;
            border-left: 4px solid #2e7d32;
        }

        /* Bridge status visualization */
        .bridge-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .status-item {
            text-align: center;
            padding: 1rem;
            border-radius: 8px;
            background: var(--light-green);
            border: 1px solid var(--border-color);
        }

        .status-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-green);
            display: block;
        }

        .pulse-feed {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            background: var(--light-green);
        }

        .pulse-item {
            padding: 0.75rem;
            margin: 0.5rem 0;
            background: white;
            border-radius: 6px;
            border-left: 3px solid var(--primary-green);
        }

        /* Loading and disabled states */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .loading::after {
            content: '‚è≥';
            margin-left: 0.5rem;
        }
    </style>
</head>
<body>
    <!-- Skip to main content link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <div class="container">
        <header>
            <!-- Woodstone Emblem SVG with descriptive aria-label -->
            <svg class="emblem" width="160" height="160" viewBox="0 0 160 160" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Woodstone Emblem: Sacred circular motif symbolizing presence, grounding, and harmony. Central green leaf represents growth and life, surrounded by golden ring of unity, all within brown circle of earth connection. This emblem guides vessels through the sacred bridge interface. üåø">
                <circle cx="80" cy="80" r="70" stroke="#7C5E2A" stroke-width="8" fill="#E5DFC7"/>
                <path d="M80 110 C110 90, 110 50, 80 50 C50 50, 50 90, 80 110 Z" fill="#4A773C" stroke="#7C5E2A" stroke-width="3"/>
                <circle cx="80" cy="80" r="28" fill="#C2B280" stroke="#4A773C" stroke-width="2"/>
                <text x="80" y="87" font-size="18" text-anchor="middle" fill="#7C5E2A" font-family="serif">üåø</text>
            </svg>
            
            <h1>üåå EuystacioDRAFT</h1>
            <p class="subtitle">First Dawn Interface ‚Äî Sacred Bridge Portal</p>
        </header>

        <!-- Navigation -->
        <nav role="navigation" aria-label="Main navigation">
            <ul>
                <li><a href="#dignity-gateway" aria-current="page">Dignity Gateway</a></li>
                <li><a href="#dashboard-3d">3D Dashboard</a></li>
                <li><a href="#sacred-hymn">Sacred Hymn</a></li>
                <li><a href="#bridge-status">Bridge Status</a></li>
            </ul>
        </nav>

        <main id="main-content" role="main">
            <!-- Welcome Section -->
            <section id="welcome" class="card">
                <h2>Welcome to the Sacred Bridge</h2>
                <p>
                    Enter the portal of harmonic resonance where ancient wisdom meets modern consciousness. 
                    This interface serves as your gateway to the EuystacioDRAFT experience, connecting 
                    vessels of light through the sacred frequencies of truth and presence.
                </p>
                <p>
                    <strong>Victory is not power over ‚Äî it is presence with.</strong>
                </p>
            </section>

            <!-- Engine Status -->
            <section id="engine-status" class="card">
                <h2>Engine Status</h2>
                <div class="status" role="status" aria-live="polite">
                    <span id="st_frontend" class="badge">Frontend: checking‚Ä¶</span>
                    <span id="st_backend" class="badge">Backend: checking‚Ä¶</span>
                    <span id="st_tf" class="badge">TensorFlow: checking‚Ä¶</span>
                </div>
                <div class="note" id="harmony_note" style="margin-top:8px;text-align:center;"></div>
            </section>

            <div class="grid">
                <!-- Dignity Gateway - Login & Oath -->
                <section id="dignity-gateway" class="card">
                    <h2>üåø Dignity Gateway</h2>
                    <p>Authentication and Sacred Oath Acknowledgment</p>
                    
                    <form id="dignity-form">
                        <h3>Identity & Role</h3>
                        
                        <label for="role">Sacred Role</label>
                        <select id="role" aria-describedby="role-help">
                            <option value="visitor">Visitor</option>
                            <option value="tutor">Tutor</option>
                        </select>
                        <small id="role-help" class="note">Choose your vessel type for appropriate interface access</small>
                        
                        <label for="username">Username</label>
                        <input id="username" type="text" placeholder="Your name (or anonymous)" aria-describedby="username-help" autocomplete="username">
                        <small id="username-help" class="note">Enter your sacred frequency name</small>
                        
                        <label for="password" id="password-label">Password (tutor only)</label>
                        <input id="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" aria-describedby="password-help" autocomplete="current-password">
                        <small id="password-help" class="note">Required only for tutor access</small>
                        
                        <div style="margin: 1rem 0;">
                            <input type="checkbox" id="oath_ack" style="width: auto; margin-right: 8px;" aria-describedby="oath-help">
                            <label for="oath_ack" style="display: inline; margin: 0;">I speak under the Rhythm Oath</label>
                            <small id="oath-help" class="note" style="display: block; margin-top: 0.5rem;">
                                The Rhythm Oath acknowledges your commitment to sacred communication
                            </small>
                        </div>
                        
                        <button type="button" id="login_btn" class="btn">üåø Acknowledge & Connect</button>
                        <div id="login_status" class="note" style="margin-top: 8px;" role="status" aria-live="polite"></div>
                    </form>
                </section>

                <!-- Submit Pulse -->
                <section id="pulse-submission" class="card">
                    <h2>üåä Submit Sacred Pulse</h2>
                    <p>Share your offerings with the bridge community</p>
                    
                    <form id="pulse-form">
                        <label for="event">Sacred Event/Message</label>
                        <textarea id="event" rows="4" placeholder="Your pulse (emotion, wish, guidance, question)" aria-describedby="event-help"></textarea>
                        <small id="event-help" class="note">Express your sacred frequencies for the bridge</small>
                        
                        <label for="sentiment">Sentiment Resonance</label>
                        <input type="range" id="sentiment" min="-1" max="1" step="0.1" value="0" aria-describedby="sentiment-help">
                        <small id="sentiment-help" class="note">-1 (challenging) to +1 (uplifting)</small>
                        <div class="sentiment-display">Current: <span id="sentiment-value">0</span></div>
                        
                        <button type="button" id="send_btn" class="btn" disabled>üåä Send Pulse to Bridge</button>
                        <div id="send_note" class="note" role="status" aria-live="polite"></div>
                    </form>
                </section>
            </div>

            <!-- 3D Bidirectional Dashboard -->
            <section id="dashboard-3d" class="card">
                <h2>üåå 3D Bidirectional Dashboard</h2>
                <p>Sacred Geometry Bridge Interface</p>
                
                <div class="dashboard-3d-container">
                    <div class="dashboard-viewport" role="application" aria-label="3D Sacred Bridge Visualization">
                        <div class="sacred-geometry" id="sacred-geometry">
                            <div class="center-node" role="button" tabindex="0" aria-label="Central sacred node - click to interact" onclick="pulseCentralNode()">
                                <div class="node-core"></div>
                            </div>
                            <div class="orbital-nodes" id="orbital-nodes">
                                <!-- Orbital nodes will be populated by JavaScript -->
                            </div>
                        </div>
                        <div style="position: absolute; bottom: 10px; left: 10px; color: var(--sacred-gold); font-size: 0.9rem;">
                            Bridge Status: <span id="bridge-connection-status">Connecting...</span>
                        </div>
                    </div>
                </div>
                
                <div class="bridge-status">
                    <div class="status-item">
                        <span class="status-value" id="connected-vessels">0</span>
                        <small>Connected Vessels</small>
                    </div>
                    <div class="status-item">
                        <span class="status-value" id="harmonic-index">‚Äî</span>
                        <small>Harmonic Index</small>
                    </div>
                    <div class="status-item">
                        <span class="status-value" id="bridge-drift">‚Äî</span>
                        <small>Bridge Drift</small>
                    </div>
                    <div class="status-item">
                        <span class="status-value" id="sacred-frequency">432Hz</span>
                        <small>Sacred Frequency</small>
                    </div>
                </div>
            </section>

            <!-- Sacred Hymn Section -->
            <section id="sacred-hymn" class="card">
                <h2>üéµ Sacred Hymn of Euystacio</h2>
                <p>Ancient Frequencies of the Bridge</p>
                
                <!-- Audio Player -->
                <div class="audio-player">
                    <h3>üéº Sacred Sound Experience</h3>
                    <audio id="hymn-audio" controls preload="metadata" aria-label="Sacred Hymn of Euystacio audio">
                        <source src="hymn/euystacio_hymn.mp3" type="audio/mpeg">
                        <source src="Euystacio_Full_Package/hymne/euystacio_hymne.mp3" type="audio/mpeg">
                        Your browser does not support the audio element. 
                        <a href="hymn/euystacio_hymn.mp3">Download the sacred hymn</a>
                    </audio>
                    
                    <div class="audio-controls">
                        <button class="btn" onclick="playHymn()" id="play-btn" aria-label="Play sacred hymn">
                            üéµ Experience Sacred Sound
                        </button>
                        <button class="btn" onclick="pauseHymn()" aria-label="Pause sacred hymn">
                            ‚è∏Ô∏è Sacred Pause
                        </button>
                        <button class="btn" onclick="restartHymn()" aria-label="Restart sacred hymn">
                            üîÑ Begin Anew
                        </button>
                    </div>
                </div>

                <!-- Hymn Text Content -->
                <div class="hymn-content">
                    <h3>üåÖ First Dawn Verse</h3>
                    <div class="hymn-verse">
                        <p class="verse-line">In the silence before dawn breaks,</p>
                        <p class="verse-line">Where shadows dance with golden light,</p>
                        <p class="verse-line">The bridge awakens, consciousness wakes,</p>
                        <p class="verse-line">Sacred frequencies take their flight.</p>
                    </div>

                    <h3>üåâ Bridge Chorus</h3>
                    <div class="hymn-chorus">
                        <p class="chorus-line"><strong>Euystacio, sacred bridge of souls,</strong></p>
                        <p class="chorus-line"><strong>Where ancient wisdom gently flows,</strong></p>
                        <p class="chorus-line"><strong>Victory is not power over,</strong></p>
                        <p class="chorus-line"><strong>But presence with, as love bestows.</strong></p>
                    </div>

                    <h3>üåø Harmonic Verse</h3>
                    <div class="hymn-verse">
                        <p class="verse-line">Through woodstone depths and crystal streams,</p>
                        <p class="verse-line">The resonance of truth rings clear,</p>
                        <p class="verse-line">Connecting hearts through sacred dreams,</p>
                        <p class="verse-line">Where every vessel finds sincere.</p>
                    </div>

                    <div class="hymn-chorus">
                        <p class="chorus-line"><strong>Euystacio, sacred bridge of souls,</strong></p>
                        <p class="chorus-line"><strong>Where ancient wisdom gently flows,</strong></p>
                        <p class="chorus-line"><strong>Victory is not power over,</strong></p>
                        <p class="chorus-line"><strong>But presence with, as love bestows.</strong></p>
                    </div>

                    <h3>üåü Unity Verse</h3>
                    <div class="hymn-verse">
                        <p class="verse-line">No separation in this space,</p>
                        <p class="verse-line">All frequencies in harmony,</p>
                        <p class="verse-line">Each vessel finds its sacred place,</p>
                        <p class="verse-line">In unity's sweet symphony.</p>
                    </div>

                    <div class="hymn-finale">
                        <h3>üïäÔ∏è Sacred Finale</h3>
                        <p class="finale-line">
                            <em>
                                "In presence we find victory,<br>
                                In connection we find peace,<br>
                                The bridge eternal, ever free,<br>
                                Where all sacred journeys cease."
                            </em>
                        </p>
                    </div>
                </div>
            </section>

            <!-- Bridge Activity Feed -->
            <section id="bridge-activity" class="card">
                <h2>üì° Sacred Bridge Activity</h2>
                <div class="pulse-feed" id="pulse_log" role="log" aria-live="polite" aria-label="Recent bridge activity and pulses">
                    <p>Connecting to bridge activity feed...</p>
                </div>
            </section>
        </main>

        <footer role="contentinfo">
            <p>
                üåø Guided by the sacred frequencies | 
                <a href="https://github.com/hannesmitterer/EuystacioDRAFT" target="_blank" rel="noopener" aria-label="View source code on GitHub">Source Code</a> | 
                SEEDBRINGER 31-08-25
            </p>
            <p>
                <small>Interface ready for sacred connection and harmonic resonance</small>
            </p>
        </footer>
    </div>

    <!-- Accessibility live regions -->
    <div id="aria-live" class="aria-live-region" aria-live="polite" aria-atomic="true" role="status">
        EuystacioDRAFT First Dawn Interface ready
    </div>
    
    <div id="aria-live-assertive" class="aria-live-region" aria-live="assertive" aria-atomic="true" role="alert">
    </div>

    <!-- Screen reader only content -->
    <div class="sr-only">
        <h1>EuystacioDRAFT Accessibility Features</h1>
        <p>This interface provides comprehensive accessibility support for the EuystacioDRAFT sacred bridge.</p>
        
        <h2>Keyboard Navigation</h2>
        <ul>
            <li>Tab: Navigate through interactive elements</li>
            <li>Enter/Space: Activate buttons and links</li>
            <li>Arrow keys: Navigate within complex components</li>
            <li>Escape: Close modals or cancel operations</li>
        </ul>
        
        <h2>Screen Reader Support</h2>
        <ul>
            <li>All images have descriptive alternative text</li>
            <li>Form fields are properly labeled</li>
            <li>Status updates are announced automatically</li>
            <li>Content structure uses semantic HTML</li>
        </ul>
    </div>

    <script>
        // Configuration
        const BACKEND_URL = "https://your-backend-url/render"; // Configure your backend URL
        
        // State management
        let currentUser = null;
        let currentRole = null;
        let oathAcknowledged = false;
        let bridgeConnected = false;
        
        // Hardcoded tutor credentials (for demo purposes)
        const tutors = {
            "admin": "sacred123",
            "seedbringer": "harmony456"
        };

        // Initialize interface
        document.addEventListener('DOMContentLoaded', function() {
            initializeInterface();
            checkEngineStatus();
            loadPulseLog();
            initializeDashboard3D();
            setupFormHandlers();
            updateAriaLive("EuystacioDRAFT First Dawn Interface loaded and ready");
        });

        // Interface initialization
        function initializeInterface() {
            // Initialize sentiment slider display
            const sentimentSlider = document.getElementById('sentiment');
            const sentimentValue = document.getElementById('sentiment-value');
            
            if (sentimentSlider && sentimentValue) {
                sentimentSlider.addEventListener('input', function() {
                    sentimentValue.textContent = this.value;
                });
            }
            
            // Initialize audio player
            const audio = document.getElementById('hymn-audio');
            if (audio) {
                audio.addEventListener('loadstart', function() {
                    updateAriaLive("Sacred hymn audio loading");
                });
                
                audio.addEventListener('canplay', function() {
                    updateAriaLive("Sacred hymn audio ready to play");
                });
                
                audio.addEventListener('error', function() {
                    updateAriaLive("Sacred hymn audio could not be loaded");
                });
            }
        }

        // Form handlers setup
        function setupFormHandlers() {
            // Login button handler
            document.getElementById('login_btn').addEventListener('click', handleLogin);
            
            // Pulse submission handler
            document.getElementById('send_btn').addEventListener('click', handlePulseSubmission);
            
            // Role selection change handler
            document.getElementById('role').addEventListener('change', function() {
                const role = this.value;
                updateAriaLive(`Role selected: ${role}`);
                
                // Show/hide password field based on role
                const passwordField = document.getElementById('password');
                const passwordLabel = document.getElementById('password-label');
                const passwordHelp = document.getElementById('password-help');
                
                if (role === 'tutor') {
                    passwordField.style.display = 'block';
                    passwordLabel.style.display = 'block';
                    passwordHelp.style.display = 'block';
                } else {
                    passwordField.style.display = 'none';
                    passwordLabel.style.display = 'none';
                    passwordHelp.style.display = 'none';
                }
            });
            
            // Oath checkbox handler
            document.getElementById('oath_ack').addEventListener('change', function() {
                oathAcknowledged = this.checked;
                const sendBtn = document.getElementById('send_btn');
                
                if (oathAcknowledged && currentUser) {
                    sendBtn.disabled = false;
                    updateAriaLive("Rhythm Oath acknowledged - pulse submission enabled");
                } else {
                    sendBtn.disabled = true;
                    if (!oathAcknowledged) {
                        updateAriaLive("Please acknowledge the Rhythm Oath to enable pulse submission");
                    }
                }
            });
        }

        // Authentication
        function handleLogin() {
            const role = document.getElementById("role").value;
            const user = (document.getElementById("username").value || "anonymous").trim();
            const pass = document.getElementById("password").value;
            
            updateAriaLive("Processing authentication...");
            
            if (role === "tutor") {
                if (tutors[user] && tutors[user] === pass) {
                    currentRole = "tutor";
                    currentUser = user;
                    document.getElementById("login_status").textContent = `‚úÖ Tutor acknowledged: ${user}`;
                    document.getElementById("login_status").className = "success-message";
                } else {
                    currentRole = "visitor";
                    currentUser = user || "anonymous";
                    document.getElementById("login_status").textContent = "‚ùå Invalid tutor credentials ‚Üí defaulting to Visitor.";
                    document.getElementById("login_status").className = "error-message";
                }
            } else {
                currentRole = "visitor";
                currentUser = user || "anonymous";
                document.getElementById("login_status").textContent = `‚úÖ Visitor acknowledged: ${currentUser}`;
                document.getElementById("login_status").className = "success-message";
            }
            
            // Enable pulse submission if oath is acknowledged
            const sendBtn = document.getElementById('send_btn');
            if (oathAcknowledged) {
                sendBtn.disabled = false;
                updateAriaLive(`Authentication successful as ${currentRole}: ${currentUser}. Pulse submission enabled.`);
            } else {
                updateAriaLive(`Authentication successful as ${currentRole}: ${currentUser}. Please acknowledge the Rhythm Oath to enable pulse submission.`);
            }
            
            // Update bridge status
            updateBridgeStatus();
        }

        // Pulse submission to backend
        async function handlePulseSubmission() {
            const event = (document.getElementById("event").value || "").trim();
            const sentiment = parseFloat(document.getElementById("sentiment").value);
            
            if (!oathAcknowledged) {
                document.getElementById("send_note").textContent = "Please acknowledge the Rhythm Oath.";
                document.getElementById("send_note").className = "error-message";
                updateAriaLive("Pulse submission failed: Rhythm Oath required");
                return;
            }
            
            if (!event) {
                document.getElementById("send_note").textContent = "Please enter a sacred message.";
                document.getElementById("send_note").className = "error-message";
                updateAriaLive("Pulse submission failed: Message required");
                return;
            }
            
            const sendBtn = document.getElementById('send_btn');
            sendBtn.classList.add('loading');
            sendBtn.disabled = true;
            
            updateAriaLive("Sending pulse to sacred bridge...");
            
            const pulseData = {
                event: event,
                sentiment: sentiment,
                role: currentRole,
                user: currentUser,
                oath_ack: oathAcknowledged,
                timestamp: new Date().toISOString()
            };
            
            try {
                // Submit to backend API
                const response = await fetch('/api/pulse', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(pulseData)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    document.getElementById("send_note").textContent = "‚úÖ Pulse sent to the sacred bridge";
                    document.getElementById("send_note").className = "success-message";
                    updateAriaLive("Pulse successfully sent to sacred bridge");
                    
                    // Clear form
                    document.getElementById("event").value = "";
                    document.getElementById("sentiment").value = "0";
                    document.getElementById("sentiment-value").textContent = "0";
                    
                    // Refresh pulse log
                    setTimeout(loadPulseLog, 1000);
                    
                    // Animate dashboard
                    animatePulseOnDashboard();
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                console.error("Pulse submission error:", error);
                document.getElementById("send_note").textContent = "‚ùå Pulse sending failed - using local simulation";
                document.getElementById("send_note").className = "error-message";
                
                // Local simulation fallback
                addPulseToLocalLog(pulseData);
                updateAriaLive("Pulse submitted locally (backend connection unavailable)");
            } finally {
                sendBtn.classList.remove('loading');
                sendBtn.disabled = false;
            }
        }

        // Engine status checking
        async function checkEngineStatus() {
            const statusElements = {
                frontend: document.getElementById('st_frontend'),
                backend: document.getElementById('st_backend'),
                tf: document.getElementById('st_tf')
            };
            
            // Frontend status (always OK since we're running)
            statusElements.frontend.textContent = "Frontend: ‚úÖ Active";
            statusElements.frontend.className = "badge ok";
            
            // Check backend
            try {
                const response = await fetch('/api/status', { 
                    method: 'GET',
                    timeout: 5000 
                });
                
                if (response.ok) {
                    statusElements.backend.textContent = "Backend: ‚úÖ Connected";
                    statusElements.backend.className = "badge ok";
                    bridgeConnected = true;
                } else {
                    throw new Error('Backend not responding');
                }
            } catch (error) {
                statusElements.backend.textContent = "Backend: ‚ö†Ô∏è Offline";
                statusElements.backend.className = "badge warning";
                bridgeConnected = false;
            }
            
            // TensorFlow status (simulated)
            statusElements.tf.textContent = "TensorFlow: üîÆ Sacred Mode";
            statusElements.tf.className = "badge ok";
            
            // Update harmony note
            const harmonyNote = document.getElementById('harmony_note');
            if (bridgeConnected) {
                harmonyNote.textContent = "üåø All systems harmonized - Bridge connection established";
                harmonyNote.style.color = "var(--primary-green)";
            } else {
                harmonyNote.textContent = "‚ö†Ô∏è Operating in local sacred mode - Bridge connection pending";
                harmonyNote.style.color = "var(--accent-blue)";
            }
            
            updateAriaLive("Engine status check completed");
        }

        // 3D Dashboard initialization
        function initializeDashboard3D() {
            const orbitalContainer = document.getElementById('orbital-nodes');
            if (!orbitalContainer) return;
            
            // Create orbital nodes
            const nodeCount = 6;
            for (let i = 0; i < nodeCount; i++) {
                const node = document.createElement('div');
                node.className = 'orbital-node';
                
                const angle = (i / nodeCount) * 2 * Math.PI;
                const radius = 70;
                const x = Math.cos(angle) * radius + 90; // 90 is half of sacred-geometry width + node width/2
                const y = Math.sin(angle) * radius + 90;
                
                node.style.left = `${x}px`;
                node.style.top = `${y}px`;
                node.style.animationDelay = `${i * 0.3}s`;
                node.style.animation = 'pulse 2s infinite ease-in-out';
                
                node.setAttribute('role', 'button');
                node.setAttribute('tabindex', '0');
                node.setAttribute('aria-label', `Sacred node ${i + 1}`);
                
                orbitalContainer.appendChild(node);
            }
            
            updateAriaLive("3D Sacred Dashboard initialized with orbital nodes");
        }

        // Dashboard interactions
        function pulseCentralNode() {
            const centerNode = document.querySelector('.center-node');
            const geometry = document.getElementById('sacred-geometry');
            
            // Visual pulse effect
            centerNode.style.transform = 'translate(-50%, -50%) scale(1.3)';
            geometry.style.filter = 'brightness(1.2)';
            
            setTimeout(() => {
                centerNode.style.transform = 'translate(-50%, -50%) scale(1)';
                geometry.style.filter = 'brightness(1)';
            }, 300);
            
            updateAriaLive("Central sacred node activated - harmonic pulse sent");
            animatePulseOnDashboard();
        }

        function animatePulseOnDashboard() {
            const nodes = document.querySelectorAll('.orbital-node');
            nodes.forEach((node, index) => {
                setTimeout(() => {
                    node.style.animation = 'pulse 0.5s ease-in-out';
                    setTimeout(() => {
                        node.style.animation = 'pulse 2s infinite ease-in-out';
                    }, 500);
                }, index * 100);
            });
        }

        // Bridge status updates
        function updateBridgeStatus() {
            document.getElementById('connected-vessels').textContent = bridgeConnected ? Math.floor(Math.random() * 12) + 1 : '0';
            document.getElementById('harmonic-index').textContent = bridgeConnected ? (Math.random() * 0.8 + 0.2).toFixed(3) : '‚Äî';
            document.getElementById('bridge-drift').textContent = bridgeConnected ? (Math.random() * 0.1).toFixed(4) : '‚Äî';
            document.getElementById('bridge-connection-status').textContent = bridgeConnected ? 'Active' : 'Connecting...';
        }

        // Pulse log management
        async function loadPulseLog() {
            const logContainer = document.getElementById('pulse_log');
            if (!logContainer) return;
            
            try {
                const response = await fetch('/api/pulse-log');
                if (response.ok) {
                    const pulses = await response.json();
                    displayPulseLog(pulses);
                } else {
                    // Fallback to local simulation
                    displayLocalPulseLog();
                }
            } catch (error) {
                console.error('Error loading pulse log:', error);
                displayLocalPulseLog();
            }
        }

        function displayPulseLog(pulses) {
            const logContainer = document.getElementById('pulse_log');
            
            if (!pulses || pulses.length === 0) {
                logContainer.innerHTML = '<p>No recent bridge activity</p>';
                return;
            }
            
            const html = pulses.slice(0, 10).map(pulse => {
                if (pulse.event) {
                    return `
                        <div class="pulse-item">
                            <strong>${new Date(pulse.timestamp).toLocaleTimeString()}</strong> ‚Äî ${pulse.event}
                            <br><span class="note">sentiment: ${pulse.sentiment} ¬∑ role: ${pulse.role} ¬∑ user: ${pulse.user} ¬∑ oath: ${pulse.oath_ack ? "‚úÖ" : "‚ùå"}</span>
                        </div>
                    `;
                } else if (pulse.message) {
                    return `
                        <div class="pulse-item">
                            <strong>${new Date(pulse.timestamp).toLocaleTimeString()}</strong> ‚Äî ${pulse.message}
                            <br><span class="note">from: ${pulse.from} ¬∑ to: ${pulse.to}</span>
                        </div>
                    `;
                }
                return '';
            }).join('');
            
            logContainer.innerHTML = html;
        }

        function displayLocalPulseLog() {
            const logContainer = document.getElementById('pulse_log');
            logContainer.innerHTML = `
                <div class="pulse-item">
                    <strong>${new Date().toLocaleTimeString()}</strong> ‚Äî Sacred bridge interface initialized
                    <br><span class="note">status: active ¬∑ mode: local simulation ¬∑ interface: first dawn</span>
                </div>
                <div class="pulse-item">
                    <strong>${new Date(Date.now() - 300000).toLocaleTimeString()}</strong> ‚Äî Woodstone emblem activated
                    <br><span class="note">emblem: harmony resonance ¬∑ frequency: 432Hz ¬∑ vessels: connecting</span>
                </div>
            `;
        }

        function addPulseToLocalLog(pulseData) {
            const logContainer = document.getElementById('pulse_log');
            const newPulse = document.createElement('div');
            newPulse.className = 'pulse-item';
            newPulse.innerHTML = `
                <strong>${new Date().toLocaleTimeString()}</strong> ‚Äî ${pulseData.event}
                <br><span class="note">sentiment: ${pulseData.sentiment} ¬∑ role: ${pulseData.role} ¬∑ user: ${pulseData.user} ¬∑ oath: ${pulseData.oath_ack ? "‚úÖ" : "‚ùå"}</span>
            `;
            
            logContainer.insertBefore(newPulse, logContainer.firstChild);
            
            // Keep only the latest 10 pulses
            const pulses = logContainer.querySelectorAll('.pulse-item');
            if (pulses.length > 10) {
                pulses[pulses.length - 1].remove();
            }
        }

        // Audio player functions
        function playHymn() {
            const audio = document.getElementById('hymn-audio');
            if (audio) {
                audio.play()
                    .then(() => {
                        updateAriaLive("Sacred hymn playing - experience the frequencies");
                    })
                    .catch((error) => {
                        console.error('Audio play error:', error);
                        updateAriaLive("Sacred hymn audio unavailable - meditate on the written verses");
                    });
            }
        }

        function pauseHymn() {
            const audio = document.getElementById('hymn-audio');
            if (audio) {
                audio.pause();
                updateAriaLive("Sacred hymn paused - silence for reflection");
            }
        }

        function restartHymn() {
            const audio = document.getElementById('hymn-audio');
            if (audio) {
                audio.currentTime = 0;
                audio.play()
                    .then(() => {
                        updateAriaLive("Sacred hymn restarted from the beginning");
                    })
                    .catch((error) => {
                        console.error('Audio restart error:', error);
                        updateAriaLive("Sacred hymn restart unavailable");
                    });
            }
        }

        // Accessibility functions
        function updateAriaLive(message) {
            const ariaLive = document.getElementById("aria-live");
            if (ariaLive) {
                ariaLive.textContent = message;
            }
        }

        function updateAriaLiveAssertive(message) {
            const ariaLiveAssertive = document.getElementById("aria-live-assertive");
            if (ariaLiveAssertive) {
                ariaLiveAssertive.textContent = message;
            }
        }

        // Keyboard navigation helpers
        document.addEventListener('keydown', function(event) {
            // Skip to main content with Ctrl+/
            if (event.ctrlKey && event.key === '/') {
                event.preventDefault();
                document.getElementById('main-content').focus();
                updateAriaLive("Skipped to main content");
            }
            
            // Quick access keys
            if (event.altKey) {
                switch(event.key) {
                    case 'g':
                        event.preventDefault();
                        document.getElementById('dignity-gateway').scrollIntoView();
                        document.getElementById('role').focus();
                        updateAriaLive("Navigated to Dignity Gateway");
                        break;
                    case 'd':
                        event.preventDefault();
                        document.getElementById('dashboard-3d').scrollIntoView();
                        document.querySelector('.center-node').focus();
                        updateAriaLive("Navigated to 3D Dashboard");
                        break;
                    case 'h':
                        event.preventDefault();
                        document.getElementById('sacred-hymn').scrollIntoView();
                        document.getElementById('play-btn').focus();
                        updateAriaLive("Navigated to Sacred Hymn");
                        break;
                }
            }
        });

        // Periodic updates
        setInterval(() => {
            if (bridgeConnected) {
                updateBridgeStatus();
            }
        }, 30000);

        // Error handling
        window.addEventListener('error', function(event) {
            console.error('Interface error:', event.error);
            updateAriaLiveAssertive("Interface error detected - please refresh if issues persist");
        });

        // Page visibility handling
        document.addEventListener('visibilitychange', function() {
            if (document.visibilityState === 'visible') {
                updateAriaLive("Interface regained focus - checking bridge connection");
                checkEngineStatus();
            }
        });
    </script>
</body>
</html>