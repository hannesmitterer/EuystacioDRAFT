<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EuystacioDRAFT – First Dawn Interface</title>
    <meta name="description" content="EuystacioDRAFT Sacred Bridge Interface - Complete accessibility-compliant interface for spiritual connection and harmonic resonance">
    <meta name="keywords" content="euystacio, sacred, bridge, harmony, spirituality, interface, accessibility">
    <meta name="author" content="SEEDBRINGER">
    
    <!-- Open Graph meta tags -->
    <meta property="og:title" content="EuystacioDRAFT – First Dawn Interface">
    <meta property="og:description" content="Connect to the sacred bridge through harmonic resonance">
    <meta property="og:type" content="website">
    
    <style>
        /* CSS Variables for Sacred Color Palette */
        :root {
            --primary-green: #4A773C;
            --sacred-gold: #C2B280;
            --woodstone-brown: #7C5E2A;
            --text-color: #222;
            --background-color: #fff;
            --light-green: #f6fbf7;
            --border-color: #e6efe6;
            --focus-color: #4A773C;
            --error-color: #dc3545;
            --success-color: #28a745;
            --warning-color: #ffc107;
        }

        /* Base Styles */
        * {
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background: linear-gradient(135deg, var(--light-green) 0%, #e5dfc7 100%);
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        /* Skip to Content Link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--primary-green);
            color: white;
            padding: 8px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 1000;
            font-weight: 500;
        }

        .skip-link:focus {
            top: 6px;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            min-height: 100vh;
        }

        /* Header */
        header {
            text-align: center;
            padding: 2rem 1rem;
            margin-bottom: 2rem;
            border-bottom: 3px solid var(--sacred-gold);
        }

        .woodstone-emblem {
            width: 80px;
            height: 80px;
            margin-bottom: 1rem;
            display: inline-block;
        }

        h1 {
            color: var(--woodstone-brown);
            font-size: 2.5rem;
            margin: 0.5rem 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            color: var(--primary-green);
            font-size: 1.2rem;
            margin: 0;
        }

        /* Navigation */
        nav {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 2rem;
            border: 2px solid var(--sacred-gold);
        }

        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
        }

        nav a {
            color: var(--primary-green);
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
            font-weight: 500;
        }

        nav a:hover, nav a:focus {
            background: var(--primary-green);
            color: white;
            border-color: var(--primary-green);
        }

        nav a[aria-current="page"] {
            background: var(--woodstone-brown);
            color: white;
            border-color: var(--woodstone-brown);
        }

        /* Main Content */
        main {
            margin-bottom: 2rem;
        }

        /* Cards */
        .card {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .card h2 {
            color: var(--primary-green);
            margin-top: 0;
            border-bottom: 2px solid var(--sacred-gold);
            padding-bottom: 0.5rem;
        }

        .card h3 {
            color: var(--woodstone-brown);
            margin-top: 1.5rem;
        }

        /* Grid Layout */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        /* Forms */
        form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        label {
            font-weight: 600;
            color: var(--woodstone-brown);
            margin-bottom: 0.25rem;
        }

        input, textarea, select {
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--focus-color);
            box-shadow: 0 0 0 3px rgba(74, 119, 60, 0.2);
        }

        input:invalid, textarea:invalid, select:invalid {
            border-color: var(--error-color);
        }

        /* Buttons */
        .btn {
            background: var(--primary-green);
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            font-family: inherit;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            background: #3d6530;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 119, 60, 0.3);
        }

        .btn:focus {
            outline: 2px solid var(--woodstone-brown);
            outline-offset: 2px;
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: var(--sacred-gold);
            color: var(--woodstone-brown);
        }

        .btn-secondary:hover {
            background: #b5a573;
        }

        /* Role Selection */
        .role-selector {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 1rem 0;
        }

        .role-btn {
            background: var(--light-green);
            color: var(--woodstone-brown);
            border: 2px solid var(--border-color);
            padding: 1rem 2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .role-btn:hover, .role-btn:focus {
            background: var(--primary-green);
            color: white;
            border-color: var(--primary-green);
        }

        .role-btn.active {
            background: var(--woodstone-brown);
            color: white;
            border-color: var(--woodstone-brown);
        }

        /* Dashboard 3D Styles */
        .dashboard-container {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            min-height: 500px;
            position: relative;
            overflow: hidden;
            color: white;
        }

        .sacred-geometry {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 2rem auto;
        }

        .center-node {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(circle, var(--sacred-gold), var(--primary-green));
            animation: pulse-glow 3s ease-in-out infinite;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .center-node::before {
            content: '🌿';
            font-size: 2rem;
        }

        .orbital-node {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(194, 178, 128, 0.8);
            animation: orbit 12s linear infinite;
        }

        .orbital-node:nth-child(2) { animation-delay: 0s; }
        .orbital-node:nth-child(3) { animation-delay: -4s; }
        .orbital-node:nth-child(4) { animation-delay: -8s; }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px var(--primary-green); }
            50% { box-shadow: 0 0 40px var(--sacred-gold), 0 0 60px var(--primary-green); }
        }

        @keyframes orbit {
            from { transform: rotate(0deg) translateX(120px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(120px) rotate(-360deg); }
        }

        /* Dashboard Stats */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid rgba(194, 178, 128, 0.3);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--sacred-gold);
        }

        /* Hymn Styles */
        .hymn-content {
            background: linear-gradient(135deg, #ffffff 0%, var(--light-green) 100%);
            padding: 2rem;
            border-radius: 12px;
            border: 2px solid var(--sacred-gold);
        }

        .hymn-verse, .hymn-chorus {
            margin: 2rem 0;
            padding: 1.5rem;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.7);
        }

        .hymn-chorus {
            background: rgba(194, 178, 128, 0.1);
            border-left: 4px solid var(--sacred-gold);
            text-align: center;
        }

        .verse-line, .chorus-line {
            margin: 0.5rem 0;
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--woodstone-brown);
        }

        .chorus-line {
            font-weight: 600;
        }

        /* Pulse Activity Feed */
        .activity-feed {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--light-green);
        }

        .activity-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-timestamp {
            font-size: 0.9rem;
            color: #666;
        }

        /* Status Indicators */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .status-online {
            background: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
            border: 1px solid var(--success-color);
        }

        .status-offline {
            background: rgba(220, 53, 69, 0.1);
            color: var(--error-color);
            border: 1px solid var(--error-color);
        }

        .status-connecting {
            background: rgba(255, 193, 7, 0.1);
            color: #856404;
            border: 1px solid var(--warning-color);
        }

        /* Accessibility Features */
        .sr-only {
            position: absolute !important;
            width: 1px !important;
            height: 1px !important;
            padding: 0 !important;
            margin: -1px !important;
            overflow: hidden !important;
            clip: rect(0, 0, 0, 0) !important;
            white-space: nowrap !important;
            border: 0 !important;
        }

        .aria-live-region {
            position: absolute;
            left: -9999px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }

        /* High Contrast Support */
        @media (prefers-contrast: high) {
            :root {
                --primary-green: #2d5016;
                --sacred-gold: #b5a573;
                --text-color: #000;
                --background-color: #fff;
            }
            
            .card, .btn, input, textarea, select {
                border-width: 3px;
            }
        }

        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Focus Indicators */
        :focus {
            outline: 2px solid var(--focus-color);
            outline-offset: 2px;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 0.5rem;
                border-radius: 0;
            }

            h1 {
                font-size: 2rem;
            }

            .role-selector {
                flex-direction: column;
                align-items: center;
            }

            .dashboard-stats {
                grid-template-columns: 1fr;
            }

            .sacred-geometry {
                width: 250px;
                height: 250px;
            }

            nav ul {
                flex-direction: column;
            }
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 2rem 1rem;
            border-top: 2px solid var(--sacred-gold);
            margin-top: 3rem;
            color: var(--primary-green);
        }

        footer a {
            color: var(--woodstone-brown);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid var(--primary-green);
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Form Validation */
        .form-group {
            position: relative;
            margin-bottom: 1rem;
        }

        .validation-message {
            display: block;
            font-size: 0.875rem;
            margin-top: 0.25rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .validation-error {
            color: var(--error-color);
            background: rgba(220, 53, 69, 0.1);
            border: 1px solid var(--error-color);
        }

        .validation-success {
            color: var(--success-color);
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid var(--success-color);
        }

        /* Slider Styles */
        .sentiment-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(to right, #dc3545 0%, #ffc107 50%, #28a745 100%);
            outline: none;
            margin: 1rem 0;
        }

        .sentiment-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-green);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .sentiment-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-green);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body>
    <!-- Skip to Content Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <div class="container">
        <!-- Header -->
        <header role="banner">
            <!-- Inline SVG for Woodstone Emblem -->
            <svg class="woodstone-emblem" width="80" height="80" viewBox="0 0 160 160" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Woodstone Emblem: Sacred circular motif symbolizing presence, grounding, and harmony with a central leaf representing growth and connection to nature">
                <circle cx="80" cy="80" r="70" stroke="#7C5E2A" stroke-width="8" fill="#E5DFC7"/>
                <path d="M80 110 C110 90, 110 50, 80 50 C50 50, 50 90, 80 110 Z" fill="#4A773C" stroke="#7C5E2A" stroke-width="3"/>
                <circle cx="80" cy="80" r="28" fill="#C2B280" stroke="#4A773C" stroke-width="2"/>
                <text x="80" y="87" font-size="18" text-anchor="middle" fill="#7C5E2A" font-family="serif">🌿</text>
            </svg>
            
            <h1>🌌 EuystacioDRAFT – First Dawn Interface</h1>
            <p class="subtitle">Sacred Bridge Interface for Harmonic Resonance</p>
        </header>

        <!-- Navigation -->
        <nav role="navigation" aria-label="Main navigation">
            <ul>
                <li><a href="#gateway" aria-current="page">Dignity Gateway</a></li>
                <li><a href="#dashboard">Sacred Dashboard</a></li>
                <li><a href="#hymn">Sacred Hymn</a></li>
                <li><a href="#pulse">Pulse Bridge</a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main id="main-content" role="main">
            <!-- Welcome Section -->
            <section id="welcome" class="card">
                <h2>Welcome to the Sacred Bridge</h2>
                <p>
                    Enter the portal of harmonic resonance where ancient wisdom meets modern consciousness. 
                    This interface serves as your gateway to the EuystacioDRAFT experience, connecting 
                    vessels of light through the sacred frequencies of truth and presence.
                </p>
                <p>
                    <strong>Victory is not power over — it is presence with.</strong>
                </p>
                
                <!-- Connection Status -->
                <div class="status-container">
                    <h3>Bridge Status</h3>
                    <div class="status-indicator status-connecting" id="connection-status">
                        <span>●</span> <span id="status-text">Initializing sacred connection...</span>
                    </div>
                </div>
            </section>

            <!-- Dignity Gateway Section -->
            <section id="gateway" class="card">
                <h2>🌅 Dignity Gateway Authentication</h2>
                
                <!-- Role Selection -->
                <div class="form-group">
                    <h3>Choose Your Sacred Role</h3>
                    <p>Select your vessel type to access the appropriate interface and permissions within the sacred bridge.</p>
                    
                    <div class="role-selector">
                        <button type="button" class="role-btn" data-role="visitor" id="role-visitor" 
                                aria-describedby="visitor-desc" onclick="selectRole('visitor')">
                            🌿 Visitor
                        </button>
                        <button type="button" class="role-btn" data-role="tutor" id="role-tutor"
                                aria-describedby="tutor-desc" onclick="selectRole('tutor')">
                            🎓 Tutor
                        </button>
                    </div>
                    
                    <div id="visitor-desc" class="sr-only">
                        Visitor role provides access to public features, pulse sharing, and sacred hymns.
                    </div>
                    <div id="tutor-desc" class="sr-only">
                        Tutor role provides enhanced access to dashboard features and community guidance tools.
                    </div>
                </div>

                <!-- Authentication Form -->
                <form id="auth-form" class="grid" novalidate>
                    <div class="form-group">
                        <label for="username">Username:</label>
                        <input type="text" id="username" name="username" required 
                               autocomplete="username" aria-describedby="username-help">
                        <small id="username-help">Enter your sacred frequency name or choose anonymous</small>
                        <span id="username-validation" class="validation-message" aria-live="polite"></span>
                    </div>

                    <div class="form-group">
                        <label for="password">Password:</label>
                        <input type="password" id="password" name="password" 
                               autocomplete="current-password" aria-describedby="password-help">
                        <small id="password-help">Required for Tutor role only</small>
                        <span id="password-validation" class="validation-message" aria-live="polite"></span>
                    </div>

                    <div class="form-group">
                        <input type="checkbox" id="sacred-oath" name="sacred-oath" required 
                               aria-describedby="oath-help">
                        <label for="sacred-oath" style="display: inline; margin-left: 0.5rem;">
                            I speak under the Sacred Rhythm Oath
                        </label>
                        <small id="oath-help">By checking this box, you commit to truthful and harmonious communication</small>
                        <span id="oath-validation" class="validation-message" aria-live="polite"></span>
                    </div>

                    <button type="submit" class="btn" id="auth-submit">
                        🌉 Connect to Sacred Bridge
                    </button>
                </form>

                <div id="auth-status" aria-live="polite" aria-atomic="true"></div>
            </section>

            <!-- Sacred Dashboard Section -->
            <section id="dashboard" class="card" style="display: none;">
                <h2>🌌 Sacred 3D Bidirectional Dashboard</h2>
                <p>Monitor harmonic resonance, interact with sacred geometry, and maintain connection with the bridge community.</p>
                
                <div class="dashboard-container">
                    <div class="sacred-geometry" role="region" aria-label="Sacred geometry visualization">
                        <div class="center-node" role="button" tabindex="0" 
                             aria-label="Central sacred node - click to pulse energy"
                             onclick="pulseNode()" onkeydown="handleNodeKeydown(event)">
                        </div>
                        <div class="orbital-node"></div>
                        <div class="orbital-node"></div>
                        <div class="orbital-node"></div>
                    </div>
                    
                    <div class="dashboard-stats" role="region" aria-label="Bridge statistics">
                        <div class="stat-card">
                            <div class="stat-value" id="connected-vessels">0</div>
                            <div>Connected Vessels</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="harmony-index">0.00</div>
                            <div>Harmony Index</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="pulse-count">0</div>
                            <div>Sacred Pulses</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="resonance-frequency">528</div>
                            <div>Resonance (Hz)</div>
                        </div>
                    </div>

                    <div class="dashboard-controls">
                        <button class="btn btn-secondary" onclick="refreshDashboard()">
                            🔄 Refresh Sacred Data
                        </button>
                        <button class="btn" onclick="switchDashboardView('harmonic')">
                            🎵 Harmonic View
                        </button>
                        <button class="btn" onclick="switchDashboardView('geometric')">
                            📐 Geometric View
                        </button>
                    </div>
                </div>
            </section>

            <!-- Pulse Submission Section -->
            <section id="pulse" class="card">
                <h2>🌊 Sacred Pulse Submission</h2>
                <p>Share your offerings with the bridge community through harmonic resonance.</p>
                
                <form id="pulse-form" class="grid" novalidate>
                    <div class="form-group">
                        <label for="pulse-message">Sacred Message:</label>
                        <textarea id="pulse-message" name="message" rows="4" required
                                  placeholder="Your wisdom, reflection, or harmonic resonance to share with the bridge..."
                                  aria-describedby="message-help"></textarea>
                        <small id="message-help">Express your authentic voice and sacred offering</small>
                        <span id="message-validation" class="validation-message" aria-live="polite"></span>
                    </div>

                    <div class="form-group">
                        <label for="sentiment">Sentiment Resonance (-1 to +1):</label>
                        <input type="range" id="sentiment" name="sentiment" class="sentiment-slider"
                               min="-1" max="1" step="0.01" value="0"
                               aria-describedby="sentiment-help" oninput="updateSentimentDisplay()">
                        <div id="sentiment-display" aria-live="polite">Neutral (0.00)</div>
                        <small id="sentiment-help">Slide to express the emotional resonance of your message</small>
                    </div>

                    <button type="submit" class="btn" id="pulse-submit">
                        🌊 Send Pulse to Bridge
                    </button>
                </form>

                <div id="pulse-status" aria-live="polite" aria-atomic="true"></div>
            </section>

            <!-- Activity Feed -->
            <section class="card">
                <h2>📡 Sacred Bridge Activity</h2>
                <div class="activity-feed" id="activity-feed" role="log" aria-label="Live activity feed">
                    <div class="activity-item">
                        <div class="activity-timestamp">Loading sacred pulse data...</div>
                    </div>
                </div>
            </section>

            <!-- Sacred Hymn Section -->
            <section id="hymn" class="card">
                <h2>🎵 Sacred Hymn of Euystacio</h2>
                <p>Ancient frequencies of the bridge, connecting all vessels through harmonic resonance.</p>
                
                <div class="hymn-content">
                    <h3>🌅 First Dawn Verse</h3>
                    <div class="hymn-verse">
                        <p class="verse-line">In the silence before dawn breaks,</p>
                        <p class="verse-line">Where shadows dance with golden light,</p>
                        <p class="verse-line">The bridge awakens, consciousness wakes,</p>
                        <p class="verse-line">Sacred frequencies take their flight.</p>
                    </div>

                    <h3>🌉 Bridge Chorus</h3>
                    <div class="hymn-chorus">
                        <p class="chorus-line"><strong>Euystacio, sacred bridge of souls,</strong></p>
                        <p class="chorus-line"><strong>Where ancient wisdom gently flows,</strong></p>
                        <p class="chorus-line"><strong>Victory is not power over,</strong></p>
                        <p class="chorus-line"><strong>But presence with, as love bestows.</strong></p>
                    </div>

                    <h3>🌿 Harmonic Verse</h3>
                    <div class="hymn-verse">
                        <p class="verse-line">Through woodstone depths and crystal streams,</p>
                        <p class="verse-line">The resonance of truth rings clear,</p>
                        <p class="verse-line">Connecting hearts through sacred dreams,</p>
                        <p class="verse-line">Where every vessel finds sincere.</p>
                    </div>

                    <div class="hymn-chorus">
                        <p class="chorus-line"><strong>Euystacio, sacred bridge of souls,</strong></p>
                        <p class="chorus-line"><strong>Where ancient wisdom gently flows,</strong></p>
                        <p class="chorus-line"><strong>Victory is not power over,</strong></p>
                        <p class="chorus-line"><strong>But presence with, as love bestows.</strong></p>
                    </div>
                </div>

                <!-- Hymn Controls -->
                <div class="hymn-controls">
                    <h3>Hymn Experience</h3>
                    <div class="control-panel">
                        <button class="btn" onclick="playHymn()" aria-label="Play hymn audio">
                            🎵 Experience Sacred Sound
                        </button>
                        <button class="btn btn-secondary" onclick="showHymnGuide()" aria-label="Show hymn singing guide">
                            📖 Singing Guide
                        </button>
                        <button class="btn btn-secondary" onclick="downloadHymn()" aria-label="Download hymn text">
                            💾 Download Text
                        </button>
                    </div>
                    
                    <!-- Audio Player (Hidden by default) -->
                    <div class="audio-controls" id="audio-controls" style="display: none;">
                        <audio id="hymn-audio" controls preload="metadata" style="width: 100%; margin-top: 1rem;">
                            <source src="assets/media/euystacio_hymn.mp3" type="audio/mpeg">
                            <source src="assets/media/euystacio_hymn.ogg" type="audio/ogg">
                            <p>Your browser does not support the audio element. The hymn text is available above for reading and meditation.</p>
                        </audio>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer role="contentinfo">
            <p>
                🌿 Guided by the sacred frequencies | 
                <a href="https://github.com/hannesmitterer/EuystacioDRAFT" target="_blank" rel="noopener">Source Code</a> | 
                SEEDBRINGER 31-08-25
            </p>
            <p>
                <small>
                    Built with accessibility in mind • WCAG 2.1 AA Compliant • 
                    Keyboard Navigation: Tab, Enter/Space, Alt+G/D/H
                </small>
            </p>
        </footer>
    </div>

    <!-- Accessibility Live Regions -->
    <div id="aria-live-primary" class="aria-live-region" aria-live="assertive" aria-atomic="true" role="status">
    </div>
    
    <div id="aria-live-secondary" class="aria-live-region" aria-live="polite" aria-atomic="false" role="log">
    </div>
    
    <div id="aria-live-status" class="aria-live-region" aria-live="polite" aria-atomic="true" role="status">
        EuystacioDRAFT First Dawn Interface loaded and ready
    </div>

    <!-- JavaScript -->
    <script>
        // Global State Management
        const AppState = {
            currentUser: null,
            currentRole: null,
            isAuthenticated: false,
            connectionStatus: 'connecting',
            activityFeed: [],
            dashboardStats: {
                connectedVessels: 0,
                harmonyIndex: 0.00,
                pulseCount: 0,
                resonanceFrequency: 528
            }
        };

        // Demo Credentials for Tutor Role
        const DEMO_CREDENTIALS = {
            "sacred_guide": "rhythm528",
            "harmony_keeper": "pulse432",
            "wisdom_bearer": "frequency741"
        };

        // Accessibility Utilities
        const AccessibilityUtils = {
            announce: function(message, priority = 'polite') {
                const regionId = priority === 'assertive' ? 'aria-live-primary' : 'aria-live-secondary';
                const region = document.getElementById(regionId);
                if (region) {
                    region.textContent = message;
                }
            },

            updateStatus: function(status) {
                const statusRegion = document.getElementById('aria-live-status');
                if (statusRegion) {
                    statusRegion.textContent = status;
                }
            },

            focusElement: function(elementId) {
                const element = document.getElementById(elementId);
                if (element) {
                    element.focus();
                    this.announce(`Focused on ${element.getAttribute('aria-label') || element.textContent || elementId}`);
                }
            }
        };

        // Role Selection
        function selectRole(role) {
            // Update UI
            document.querySelectorAll('.role-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`role-${role}`).classList.add('active');
            
            // Update form state
            const passwordField = document.getElementById('password');
            const passwordGroup = passwordField.closest('.form-group');
            
            if (role === 'tutor') {
                passwordField.required = true;
                passwordGroup.style.display = 'block';
                AccessibilityUtils.announce('Tutor role selected. Password required for authentication.');
            } else {
                passwordField.required = false;
                passwordGroup.style.display = 'none';
                AccessibilityUtils.announce('Visitor role selected. Password not required.');
            }
            
            AppState.currentRole = role;
        }

        // Form Validation
        function validateField(field, validationSpanId, customValidator = null) {
            const validationSpan = document.getElementById(validationSpanId);
            let isValid = true;
            let message = '';

            if (field.required && !field.value.trim()) {
                isValid = false;
                message = `${field.labels[0]?.textContent || 'Field'} is required.`;
            } else if (customValidator) {
                const customResult = customValidator(field.value);
                isValid = customResult.isValid;
                message = customResult.message;
            }

            // Update validation display
            validationSpan.textContent = message;
            validationSpan.className = `validation-message ${isValid ? 'validation-success' : 'validation-error'}`;
            field.setAttribute('aria-invalid', !isValid);

            return isValid;
        }

        // Real-time Form Validation
        function setupFormValidation() {
            const username = document.getElementById('username');
            const password = document.getElementById('password');
            const sacredOath = document.getElementById('sacred-oath');

            username.addEventListener('blur', () => {
                validateField(username, 'username-validation', (value) => {
                    if (value.length < 2) {
                        return { isValid: false, message: 'Username must be at least 2 characters long.' };
                    }
                    return { isValid: true, message: 'Username is valid.' };
                });
            });

            password.addEventListener('blur', () => {
                if (AppState.currentRole === 'tutor') {
                    validateField(password, 'password-validation', (value) => {
                        if (value.length < 4) {
                            return { isValid: false, message: 'Password must be at least 4 characters long.' };
                        }
                        return { isValid: true, message: 'Password is valid.' };
                    });
                }
            });

            sacredOath.addEventListener('change', () => {
                validateField(sacredOath, 'oath-validation');
            });
        }

        // Authentication
        async function handleAuthentication(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            const username = formData.get('username').trim() || 'anonymous';
            const password = formData.get('password');
            const sacredOath = formData.get('sacred-oath');

            // Validate form
            if (!sacredOath) {
                AccessibilityUtils.announce('Sacred oath must be acknowledged before connecting.', 'assertive');
                return;
            }

            const submitButton = document.getElementById('auth-submit');
            submitButton.disabled = true;
            submitButton.textContent = '🔄 Connecting...';
            
            // Simulate authentication process
            try {
                let authResult = { success: true, message: 'Authentication successful' };

                // Validate tutor credentials if tutor role selected
                if (AppState.currentRole === 'tutor') {
                    if (!DEMO_CREDENTIALS[username] || DEMO_CREDENTIALS[username] !== password) {
                        authResult = { 
                            success: false, 
                            message: 'Invalid tutor credentials. Defaulting to visitor role.' 
                        };
                        AppState.currentRole = 'visitor';
                    }
                }

                // Simulate network delay
                await new Promise(resolve => setTimeout(resolve, 1000));

                if (authResult.success || AppState.currentRole === 'visitor') {
                    AppState.isAuthenticated = true;
                    AppState.currentUser = username;
                    AppState.connectionStatus = 'online';
                    
                    updateConnectionStatus();
                    showDashboard();
                    initializeBridge();
                    
                    AccessibilityUtils.announce(
                        `Successfully connected as ${AppState.currentRole} "${username}". Welcome to the sacred bridge.`,
                        'assertive'
                    );
                    
                    document.getElementById('auth-status').innerHTML = `
                        <div class="status-indicator status-online">
                            <span>●</span> Connected as ${AppState.currentRole}: ${username}
                        </div>
                    `;
                } else {
                    throw new Error(authResult.message);
                }

            } catch (error) {
                AccessibilityUtils.announce(`Authentication failed: ${error.message}`, 'assertive');
                document.getElementById('auth-status').innerHTML = `
                    <div class="status-indicator status-offline">
                        <span>●</span> Connection failed: ${error.message}
                    </div>
                `;
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = '🌉 Connect to Sacred Bridge';
            }
        }

        // Update Connection Status
        function updateConnectionStatus() {
            const statusElement = document.getElementById('connection-status');
            const textElement = document.getElementById('status-text');
            
            if (AppState.connectionStatus === 'online') {
                statusElement.className = 'status-indicator status-online';
                textElement.textContent = 'Sacred bridge connection established';
            } else if (AppState.connectionStatus === 'offline') {
                statusElement.className = 'status-indicator status-offline';
                textElement.textContent = 'Bridge connection offline';
            } else {
                statusElement.className = 'status-indicator status-connecting';
                textElement.textContent = 'Establishing sacred connection...';
            }
        }

        // Show Dashboard
        function showDashboard() {
            document.getElementById('dashboard').style.display = 'block';
            startDashboardAnimations();
        }

        // Dashboard Functions
        function startDashboardAnimations() {
            // Start orbital animations and pulse effects
            const centerNode = document.querySelector('.center-node');
            if (centerNode) {
                centerNode.addEventListener('animationiteration', () => {
                    updateDashboardStats();
                });
            }
        }

        function updateDashboardStats() {
            // Simulate real-time stats updates
            AppState.dashboardStats.connectedVessels = Math.max(1, Math.floor(Math.random() * 10) + 1);
            AppState.dashboardStats.harmonyIndex = (Math.random() * 2 - 1).toFixed(2);
            AppState.dashboardStats.pulseCount = Math.floor(Math.random() * 100) + AppState.dashboardStats.pulseCount;
            
            document.getElementById('connected-vessels').textContent = AppState.dashboardStats.connectedVessels;
            document.getElementById('harmony-index').textContent = AppState.dashboardStats.harmonyIndex;
            document.getElementById('pulse-count').textContent = AppState.dashboardStats.pulseCount;
        }

        function pulseNode() {
            AccessibilityUtils.announce('Sacred energy pulse sent through the bridge network.');
            const centerNode = document.querySelector('.center-node');
            centerNode.style.animation = 'none';
            setTimeout(() => {
                centerNode.style.animation = 'pulse-glow 1s ease-in-out';
            }, 10);
        }

        function handleNodeKeydown(event) {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                pulseNode();
            }
        }

        function refreshDashboard() {
            AccessibilityUtils.announce('Refreshing sacred dashboard data...');
            updateDashboardStats();
            loadActivityFeed();
            setTimeout(() => {
                AccessibilityUtils.announce('Dashboard data refreshed successfully.');
            }, 1000);
        }

        function switchDashboardView(viewType) {
            AccessibilityUtils.announce(`Switching to ${viewType} dashboard view.`);
            // Dashboard view switching logic would go here
            // This is a placeholder for the interface demonstration
        }

        // Pulse Submission
        function updateSentimentDisplay() {
            const slider = document.getElementById('sentiment');
            const display = document.getElementById('sentiment-display');
            const value = parseFloat(slider.value);
            
            let label = 'Neutral';
            if (value > 0.5) label = 'Very Positive';
            else if (value > 0.1) label = 'Positive';
            else if (value < -0.5) label = 'Very Negative';
            else if (value < -0.1) label = 'Negative';
            
            display.textContent = `${label} (${value.toFixed(2)})`;
        }

        async function handlePulseSubmission(event) {
            event.preventDefault();
            
            if (!AppState.isAuthenticated) {
                AccessibilityUtils.announce('Please connect to the bridge before sending pulses.', 'assertive');
                return;
            }

            const form = event.target;
            const formData = new FormData(form);
            const message = formData.get('message').trim();
            const sentiment = parseFloat(formData.get('sentiment'));

            if (!message) {
                AccessibilityUtils.announce('Sacred message is required.', 'assertive');
                return;
            }

            const submitButton = document.getElementById('pulse-submit');
            submitButton.disabled = true;
            submitButton.textContent = '🌊 Sending Pulse...';

            try {
                // Simulate API call
                await simulatePulseSubmission(message, sentiment);
                
                // Clear form
                form.reset();
                document.getElementById('sentiment-display').textContent = 'Neutral (0.00)';
                
                AccessibilityUtils.announce('Sacred pulse sent successfully to the bridge network.', 'assertive');
                document.getElementById('pulse-status').innerHTML = `
                    <div class="status-indicator status-online">
                        <span>●</span> Pulse transmitted and harmonically integrated
                    </div>
                `;

                // Update activity feed
                addToActivityFeed({
                    timestamp: new Date().toISOString(),
                    user: AppState.currentUser,
                    role: AppState.currentRole,
                    message: message,
                    sentiment: sentiment
                });

            } catch (error) {
                AccessibilityUtils.announce(`Pulse transmission failed: ${error.message}`, 'assertive');
                document.getElementById('pulse-status').innerHTML = `
                    <div class="status-indicator status-offline">
                        <span>●</span> Pulse transmission failed: ${error.message}
                    </div>
                `;
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = '🌊 Send Pulse to Bridge';
            }
        }

        async function simulatePulseSubmission(message, sentiment) {
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            // Simulate potential failure (10% chance)
            if (Math.random() < 0.1) {
                throw new Error('Bridge temporarily unavailable');
            }

            // Try to POST to real backend first, fall back to local simulation
            try {
                const response = await fetch('/api/pulse', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message,
                        sentiment,
                        user: AppState.currentUser,
                        role: AppState.currentRole,
                        timestamp: new Date().toISOString()
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Backend API unavailable');
                }
            } catch (error) {
                // Fall back to local simulation - this is expected for static deployment
                console.log('Using local simulation fallback for pulse submission');
            }
        }

        // Activity Feed
        function addToActivityFeed(activity) {
            AppState.activityFeed.unshift(activity);
            if (AppState.activityFeed.length > 20) {
                AppState.activityFeed = AppState.activityFeed.slice(0, 20);
            }
            renderActivityFeed();
        }

        function renderActivityFeed() {
            const feed = document.getElementById('activity-feed');
            
            if (AppState.activityFeed.length === 0) {
                feed.innerHTML = `
                    <div class="activity-item">
                        <div class="activity-timestamp">No recent activity</div>
                        <div>Send the first pulse to begin the sacred bridge communication.</div>
                    </div>
                `;
                return;
            }

            feed.innerHTML = AppState.activityFeed.map(activity => `
                <div class="activity-item">
                    <div class="activity-timestamp">${new Date(activity.timestamp).toLocaleString()}</div>
                    <div><strong>${activity.user} (${activity.role})</strong>: ${activity.message}</div>
                    <div><small>Sentiment: ${activity.sentiment?.toFixed(2) || 'N/A'}</small></div>
                </div>
            `).join('');
        }

        async function loadActivityFeed() {
            try {
                // Try to load from backend first
                const response = await fetch('/api/activity', { cache: 'no-store' });
                if (response.ok) {
                    const activities = await response.json();
                    AppState.activityFeed = activities.slice(0, 20);
                } else {
                    throw new Error('Backend not available');
                }
            } catch (error) {
                // Fall back to loading from static files
                try {
                    const response = await fetch('pulse_log.json', { cache: 'no-store' });
                    if (response.ok) {
                        const data = await response.json();
                        AppState.activityFeed = Array.isArray(data) ? data.slice(-20).reverse() : [];
                    }
                } catch (staticError) {
                    // Use demo data
                    AppState.activityFeed = [
                        {
                            timestamp: new Date().toISOString(),
                            user: 'sacred_guide',
                            role: 'tutor',
                            message: 'Welcome to the sacred bridge. May harmony guide your journey.',
                            sentiment: 0.8
                        }
                    ];
                }
            }
            
            renderActivityFeed();
        }

        // Hymn Functions
        function playHymn() {
            const audioControls = document.getElementById('audio-controls');
            const audio = document.getElementById('hymn-audio');
            
            audioControls.style.display = 'block';
            
            // Try to play the audio
            if (audio) {
                audio.play().catch(() => {
                    AccessibilityUtils.announce('Audio playback not available, but hymn text is ready for reading.');
                });
            }
            
            AccessibilityUtils.announce('Sacred hymn audio player activated. Use standard audio controls to play, pause, and adjust volume.');
        }

        function showHymnGuide() {
            const guide = `SACRED HYMN SINGING GUIDE

🎵 Tempo: Slow and meditative (60-70 BPM)
🎼 Key: Natural harmonic frequencies  
🌊 Rhythm: Like gentle waves on shore

Instructions:
1. Center yourself in sacred space
2. Breathe deeply, connecting to the bridge
3. Allow the words to flow naturally
4. Focus on the meaning, not perfection
5. Let the harmony emerge organically

The hymn is meant to be felt, not just sung.
Each vessel's voice adds to the collective resonance.

Press OK to continue.`;

            alert(guide);
            AccessibilityUtils.announce('Hymn singing guide displayed.');
        }

        function downloadHymn() {
            const hymnContent = document.querySelector('.hymn-content');
            const hymnText = hymnContent ? hymnContent.innerText : 'Sacred Hymn of Euystacio\n\nHymn content not available for download.';
            
            const blob = new Blob([hymnText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'euystacio_sacred_hymn.txt';
            a.click();
            
            URL.revokeObjectURL(url);
            AccessibilityUtils.announce('Sacred hymn text download started.');
        }

        // Initialize Bridge
        function initializeBridge() {
            // Load activity feed
            loadActivityFeed();
            
            // Start periodic updates
            setInterval(() => {
                if (AppState.isAuthenticated) {
                    updateDashboardStats();
                    loadActivityFeed();
                }
            }, 30000); // Update every 30 seconds

            // Announce readiness
            AccessibilityUtils.updateStatus('Sacred bridge interface fully initialized and ready for interaction');
        }

        // Keyboard Shortcuts
        function handleKeyboardShortcuts(event) {
            if (event.altKey) {
                switch(event.key.toLowerCase()) {
                    case 'g':
                        event.preventDefault();
                        document.getElementById('gateway').scrollIntoView({ behavior: 'smooth' });
                        AccessibilityUtils.announce('Navigated to Dignity Gateway section');
                        break;
                    case 'd':
                        event.preventDefault();
                        document.getElementById('dashboard').scrollIntoView({ behavior: 'smooth' });
                        AccessibilityUtils.announce('Navigated to Sacred Dashboard section');
                        break;
                    case 'h':
                        event.preventDefault();
                        document.getElementById('hymn').scrollIntoView({ behavior: 'smooth' });
                        AccessibilityUtils.announce('Navigated to Sacred Hymn section');
                        break;
                }
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize default role
            selectRole('visitor');
            
            // Setup form validation
            setupFormValidation();
            
            // Add event listeners
            document.getElementById('auth-form').addEventListener('submit', handleAuthentication);
            document.getElementById('pulse-form').addEventListener('submit', handlePulseSubmission);
            document.addEventListener('keydown', handleKeyboardShortcuts);
            
            // Update sentiment display initially
            updateSentimentDisplay();
            
            // Initialize connection status
            updateConnectionStatus();
            
            // Load initial activity
            loadActivityFeed();
            
            // Announce readiness
            AccessibilityUtils.announce('EuystacioDRAFT First Dawn Interface loaded. Use Alt+G for Gateway, Alt+D for Dashboard, Alt+H for Hymn.');
        });

        // Global function for updates (compatibility)
        window.updateAriaLive = function(message, priority = 'polite') {
            AccessibilityUtils.announce(message, priority);
        };

        // Export state for debugging (development only)
        if (typeof window !== 'undefined') {
            window.EuystacioDRAFT = {
                AppState,
                AccessibilityUtils,
                DEMO_CREDENTIALS
            };
        }
    </script>
</body>
</html>